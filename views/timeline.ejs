
 <!DOCTYPE HTML>
<html>
<head>
    <script src="/scripts/vis.js"></script>
    <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script src='/scripts/wikipedia.js'></script>

    <link href="/styles/vis.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="/styles/timeline.css">
    <link rel="stylesheet" href="/styles/animate.css">
    <link rel="stylesheet" href="/styles/art-movement-timeline.css">

</head>
<body>

<% include partials/_search.ejs %>


<div id="visualization"></div>

<script type="text/javascript">


  // DOM element where the Timeline will be attached
  var container = document.getElementById('visualization');

  // Create a DataSet (allows two way data-binding)
  var data = <%- JSON.stringify(similars, null, 2) %>;

  var items = new vis.DataSet(data);
  console.log("items", items)


  // Configuration for the Timeline

  var options = {dataAttributes: ["id", "content", "thumbnail", "medium"]}

  // Create a Timeline
  var timeline = new vis.Timeline(container, items, options);

  timeline.on('select', function (properties) {
    console.log('item selected:', properties.event.firstTarget.parentNode.dataset.id);

    var selectedId = properties.event.firstTarget.parentNode.dataset.id;
    var thumbnailUrl = properties.event.firstTarget.parentNode.dataset.thumbnail;
    var mediumArtwork = properties.event.firstTarget.parentNode.dataset.medium;
    var nameTitle = properties.event.firstTarget.parentNode.dataset.content;

    if (selectedId !== undefined){
      console.log("thumbnailUrl", thumbnailUrl, "medium", mediumArtwork)

      document.getElementById('thumbnail').innerHTML = "<img src='" + thumbnailUrl + "'> ";

      if(mediumArtwork){
        document.getElementById('medium').innerHTML = "<div>" + mediumArtwork + "</div> "
      } else (
         document.getElementById('medium').innerHTML = "<div></div> "
        )

      document.getElementById('name').innerHTML = "<div>" + nameTitle + "</div> "


      function getById(datum){
        return datum.id === selectedId;
      }
      console.log("find", data.filter(getById))
      // console.log("find", data.filter(function(datum){return datum.id === selectedId;}))
      // console.log("find", data.filter(datum => datum.id === selectedId));

      let wikiQuery = properties.event.firstTarget.innerText.replace(/ /g, '_');
      console.log("http://en.wikipedia.org/wiki/"+ wikiQuery);


      try {

        WIKIPEDIA.getData('http://en.wikipedia.org/wiki/' + wikiQuery, function success(wikiData) {
          console.log("wikidata", wikiData);
          var artistSummary = wikiData.summary && wikiData.summary.summary
          console.log("artistSummary", artistSummary)
          if (artistSummary){
            document.getElementById('summary').innerHTML = "<div>" + artistSummary + "</div> "
            var wikiLink = "http://en.wikipedia.org/wiki/"+ wikiQuery
            document.getElementById('wikiLink').innerHTML = "<a href='" + wikiLink + "'>"+ wikiLink +"</a>"
          } else {
            document.getElementById('summary').innerHTML = "<div> Could not find summary at this time</div> "
            document.getElementById('wikiLink').innerHTML = "<a href=''></a>"
          }

        }, function wikiError(err) {
          console.log('error:', err);
        });
      } catch (err) {
        console('error:', err);
      }
    }


  });
</script>


<div id='name'></div>
<div id='summary'></div>
<div id='wikiLink'></div>
<div id='thumbnail'> </div>
<div id='medium'></div>


<% include partials/_art-movement-timeline.ejs %>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.js"></script>
    <script src="/scripts/app.js"></script>

</body>
</html>


